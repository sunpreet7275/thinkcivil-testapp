import{k as Jt}from"./chunk-Q53575U7.js";import{a as en,b as tn,c as nn}from"./chunk-LOVUNHU3.js";import{a as Ut,b as Vt}from"./chunk-E67TY2OS.js";import{a as $t,b as Ht,c as Yt,d as Gt,e as Wt,f as Xt,g as de}from"./chunk-SKYMQFZQ.js";import{a as Zt,b as Kt}from"./chunk-G5JG652A.js";import{c as lt}from"./chunk-FEPV7T3M.js";import"./chunk-TQVV7AQM.js";import{a as le,b as ce}from"./chunk-OM2PPL5L.js";import{b as Dt,c as Ft,d as At,e as qt,h as Qt,i as Rt}from"./chunk-T4HTITPZ.js";import{a as dt}from"./chunk-IL4KFIYR.js";import"./chunk-CIASAIJ4.js";import{a as me}from"./chunk-N7KCE5JO.js";import"./chunk-RG53I5Q4.js";import{a as re,b as se}from"./chunk-HS55I5IC.js";import{b as Bt,g as zt,j as ae,m as jt}from"./chunk-KTA7V4LN.js";import{a as Pt,b as Tt,c as Ot,d as kt,e as It,f as St,g as Et,h as ie,i as oe}from"./chunk-72GRF44D.js";import{C as at,E as xe,F as rt,N as st,O as ct,Q as Lt,R as te,S as ne,Z as Nt,a as Ke,b as Je,e as et,j as he,l as tt,v as nt,w as it,y as ot}from"./chunk-QFTUPGTJ.js";import{b as mt,d as k,f as pt,g as ut,j as gt,k as ft,l as _t,m as ht,o as xt,r as bt,s as vt,t as Ct,v as Mt,w as yt,x as wt}from"./chunk-VZA3E2RV.js";import"./chunk-SGWY5KE3.js";import{c as Ze}from"./chunk-E6UXEH7R.js";import"./chunk-VFMXLW2S.js";import{a as We,k as K,l as J,p as Xe,q as ee}from"./chunk-XHE2WULB.js";import{$a as c,$b as Le,Ab as F,B as j,Ba as Y,Bb as G,C as ye,Da as C,Db as Ue,Ea as Se,Hb as r,I as we,Ib as o,Ja as Ee,Jb as P,Nb as M,Oa as De,Rb as _,Sb as m,Tb as _e,U as $,Ub as W,V as fe,Vb as X,W as Pe,Wb as Ve,Xb as R,Yb as U,a as S,aa as Te,ac as s,b as E,bb as Fe,bc as w,ca as q,cc as v,d as Me,db as Ae,dc as Be,e as N,fa as g,fc as Ne,gb as qe,gc as ze,hc as je,j as z,jc as $e,kc as He,lb as D,mb as Qe,mc as Ye,na as h,nb as Re,o as ge,oa as x,oc as Ge,pa as Oe,rb as u,ta as ke,uc as Z,xa as H,xb as Q,xc as V,ya as Ie,yb as p}from"./chunk-L5KBA6Y7.js";var hn=["mat-menu-item",""],xn=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],bn=["mat-icon, [matMenuItemIcon]","*"];function vn(a,i){a&1&&(Oe(),r(0,"svg",2),P(1,"polygon",3),o())}var Cn=["*"];function Mn(a,i){if(a&1){let e=M();r(0,"div",0),_("click",function(){h(e);let n=m();return x(n.closed.emit("click"))})("animationstart",function(n){h(e);let l=m();return x(l._onAnimationStart(n.animationName))})("animationend",function(n){h(e);let l=m();return x(l._onAnimationDone(n.animationName))})("animationcancel",function(n){h(e);let l=m();return x(l._onAnimationDone(n.animationName))}),r(1,"div",1),W(2),o()()}if(a&2){let e=m();G(e._classList),F("mat-menu-panel-animations-disabled",e._animationsDisabled)("mat-menu-panel-exit-animation",e._panelAnimationState==="void")("mat-menu-panel-animating",e._isAnimating),p("id",e.panelId),Q("aria-label",e.ariaLabel||null)("aria-labelledby",e.ariaLabelledby||null)("aria-describedby",e.ariaDescribedby||null)}}var ve=new q("MAT_MENU_PANEL"),B=(()=>{class a{_elementRef=g(Y);_document=g(We);_focusMonitor=g(he);_parentMenu=g(ve,{optional:!0});_changeDetectorRef=g(Z);role="menuitem";disabled=!1;disableRipple=!1;_hovered=new z;_focused=new z;_highlighted=!1;_triggersSubmenu=!1;constructor(){g(tt).load(rt),this._parentMenu?.addItem?.(this)}focus(e,t){this._focusMonitor&&e?this._focusMonitor.focusVia(this._getHostElement(),e,t):this._getHostElement().focus(t),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(e){this.disabled&&(e.preventDefault(),e.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){let e=this._elementRef.nativeElement.cloneNode(!0),t=e.querySelectorAll("mat-icon, .material-icons");for(let n=0;n<t.length;n++)t[n].remove();return e.textContent?.trim()||""}_setHighlighted(e){this._highlighted=e,this._changeDetectorRef.markForCheck()}_setTriggersSubmenu(e){this._triggersSubmenu=e,this._changeDetectorRef.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=D({type:a,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-focus-indicator"],hostVars:8,hostBindings:function(t,n){t&1&&_("click",function(d){return n._checkDisabled(d)})("mouseenter",function(){return n._handleMouseEnter()}),t&2&&(Q("role",n.role)("tabindex",n._getTabIndex())("aria-disabled",n.disabled)("disabled",n.disabled||null),F("mat-mdc-menu-item-highlighted",n._highlighted)("mat-mdc-menu-item-submenu-trigger",n._triggersSubmenu))},inputs:{role:"role",disabled:[2,"disabled","disabled",V],disableRipple:[2,"disableRipple","disableRipple",V]},exportAs:["matMenuItem"],attrs:hn,ngContentSelectors:bn,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(t,n){t&1&&(_e(xn),W(0),r(1,"span",0),W(2,1),o(),P(3,"div",1),u(4,vn,2,0,":svg:svg",2)),t&2&&(c(3),p("matRippleDisabled",n.disableRipple||n.disabled)("matRippleTrigger",n._getHostElement()),c(),Ue(n._triggersSubmenu?4:-1))},dependencies:[st],encapsulation:2,changeDetection:0})}return a})();var yn=new q("MatMenuContent");var wn=new q("mat-menu-default-options",{providedIn:"root",factory:Pn});function Pn(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}var be="_mat-menu-enter",pe="_mat-menu-exit",A=(()=>{class a{_elementRef=g(Y);_changeDetectorRef=g(Z);_injector=g(ke);_keyManager;_xPosition;_yPosition;_firstItemFocusRef;_exitFallbackTimeout;_animationsDisabled;_allItems;_directDescendantItems=new Se;_classList={};_panelAnimationState="void";_animationDone=new z;_isAnimating=!1;parentMenu;direction;overlayPanelClass;backdropClass;ariaLabel;ariaLabelledby;ariaDescribedby;get xPosition(){return this._xPosition}set xPosition(e){this._xPosition=e,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(e){this._yPosition=e,this.setPositionClasses()}templateRef;items;lazyContent;overlapTrigger;hasBackdrop;set panelClass(e){let t=this._previousPanelClass,n=S({},this._classList);t&&t.length&&t.split(" ").forEach(l=>{n[l]=!1}),this._previousPanelClass=e,e&&e.length&&(e.split(" ").forEach(l=>{n[l]=!0}),this._elementRef.nativeElement.className=""),this._classList=n}_previousPanelClass;get classList(){return this.panelClass}set classList(e){this.panelClass=e}closed=new H;close=this.closed;panelId=g(nt).getId("mat-menu-panel-");constructor(){let e=g(wn);this.overlayPanelClass=e.overlayPanelClass||"",this._xPosition=e.xPosition,this._yPosition=e.yPosition,this.backdropClass=e.backdropClass,this.overlapTrigger=e.overlapTrigger,this.hasBackdrop=e.hasBackdrop,this._animationsDisabled=g(Ee,{optional:!0})==="NoopAnimations"}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new ot(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe($(this._directDescendantItems),fe(e=>j(...e.map(t=>t._focused)))).subscribe(e=>this._keyManager.updateActiveItem(e)),this._directDescendantItems.changes.subscribe(e=>{let t=this._keyManager;if(this._panelAnimationState==="enter"&&t.activeItem?._hasFocus()){let n=e.toArray(),l=Math.max(0,Math.min(n.length-1,t.activeItemIndex||0));n[l]&&!n[l].disabled?t.setActiveItem(l):t.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusRef?.destroy(),clearTimeout(this._exitFallbackTimeout)}_hovered(){return this._directDescendantItems.changes.pipe($(this._directDescendantItems),fe(t=>j(...t.map(n=>n._hovered))))}addItem(e){}removeItem(e){}_handleKeydown(e){let t=e.keyCode,n=this._keyManager;switch(t){case 27:it(e)||(e.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&this.direction==="ltr"&&this.closed.emit("keydown");break;case 39:this.parentMenu&&this.direction==="rtl"&&this.closed.emit("keydown");break;default:(t===38||t===40)&&n.setFocusOrigin("keyboard"),n.onKeydown(e);return}}focusFirstItem(e="program"){this._firstItemFocusRef?.destroy(),this._firstItemFocusRef=De(()=>{let t=this._resolvePanel();if(!t||!t.contains(document.activeElement)){let n=this._keyManager;n.setFocusOrigin(e).setFirstItemActive(),!n.activeItem&&t&&t.focus()}},{injector:this._injector})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(e){}setPositionClasses(e=this.xPosition,t=this.yPosition){this._classList=E(S({},this._classList),{"mat-menu-before":e==="before","mat-menu-after":e==="after","mat-menu-above":t==="above","mat-menu-below":t==="below"}),this._changeDetectorRef.markForCheck()}_onAnimationDone(e){let t=e===pe;(t||e===be)&&(t&&(clearTimeout(this._exitFallbackTimeout),this._exitFallbackTimeout=void 0),this._animationDone.next(t?"void":"enter"),this._isAnimating=!1)}_onAnimationStart(e){(e===be||e===pe)&&(this._isAnimating=!0)}_setIsOpen(e){if(this._panelAnimationState=e?"enter":"void",e){if(this._keyManager.activeItemIndex===0){let t=this._resolvePanel();t&&(t.scrollTop=0)}}else this._animationsDisabled||(this._exitFallbackTimeout=setTimeout(()=>this._onAnimationDone(pe),200));this._animationsDisabled&&setTimeout(()=>{this._onAnimationDone(e?be:pe)}),this._changeDetectorRef.markForCheck()}_updateDirectDescendants(){this._allItems.changes.pipe($(this._allItems)).subscribe(e=>{this._directDescendantItems.reset(e.filter(t=>t._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}_resolvePanel(){let e=null;return this._directDescendantItems.length&&(e=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),e}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=D({type:a,selectors:[["mat-menu"]],contentQueries:function(t,n,l){if(t&1&&(X(l,yn,5),X(l,B,5),X(l,B,4)),t&2){let d;R(d=U())&&(n.lazyContent=d.first),R(d=U())&&(n._allItems=d),R(d=U())&&(n.items=d)}},viewQuery:function(t,n){if(t&1&&Ve(Fe,5),t&2){let l;R(l=U())&&(n.templateRef=l.first)}},hostVars:3,hostBindings:function(t,n){t&2&&Q("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},inputs:{backdropClass:"backdropClass",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:[2,"overlapTrigger","overlapTrigger",V],hasBackdrop:[2,"hasBackdrop","hasBackdrop",e=>e==null?null:V(e)],panelClass:[0,"class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"},exportAs:["matMenu"],features:[$e([{provide:ve,useExisting:a}])],ngContentSelectors:Cn,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel",3,"click","animationstart","animationend","animationcancel","id"],[1,"mat-mdc-menu-content"]],template:function(t,n){t&1&&(_e(),u(0,Mn,3,12,"ng-template"))},styles:[`mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;outline:0}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;flex:1;white-space:normal;font-family:var(--mat-menu-item-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mat-menu-item-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mat-menu-item-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-menu-item-label-text-tracking, var(--mat-sys-label-large-tracking));font-weight:var(--mat-menu-item-label-text-weight, var(--mat-sys-label-large-weight))}@keyframes _mat-menu-enter{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:none}}@keyframes _mat-menu-exit{from{opacity:1}to{opacity:0}}.mat-mdc-menu-panel{min-width:112px;max-width:280px;overflow:auto;box-sizing:border-box;outline:0;animation:_mat-menu-enter 120ms cubic-bezier(0, 0, 0.2, 1);border-radius:var(--mat-menu-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mat-menu-container-color, var(--mat-sys-surface-container));box-shadow:var(--mat-menu-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12));will-change:transform,opacity}.mat-mdc-menu-panel.mat-menu-panel-exit-animation{animation:_mat-menu-exit 100ms 25ms linear forwards}.mat-mdc-menu-panel.mat-menu-panel-animations-disabled{animation:none}.mat-mdc-menu-panel.mat-menu-panel-animating{pointer-events:none}.mat-mdc-menu-panel.mat-menu-panel-animating:has(.mat-mdc-menu-content:empty){display:none}@media(forced-colors: active){.mat-mdc-menu-panel{outline:solid 1px}}.mat-mdc-menu-panel .mat-divider{color:var(--mat-menu-divider-color, var(--mat-sys-surface-variant));margin-bottom:var(--mat-menu-divider-bottom-spacing, 8px);margin-top:var(--mat-menu-divider-top-spacing, 8px)}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;min-height:48px;padding-left:var(--mat-menu-item-leading-spacing, 12px);padding-right:var(--mat-menu-item-trailing-spacing, 12px);-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-menu-item::-moz-focus-inner{border:0}[dir=rtl] .mat-mdc-menu-item{padding-left:var(--mat-menu-item-trailing-spacing, 12px);padding-right:var(--mat-menu-item-leading-spacing, 12px)}.mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-leading-spacing, 12px);padding-right:var(--mat-menu-item-with-icon-trailing-spacing, 12px)}[dir=rtl] .mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-trailing-spacing, 12px);padding-right:var(--mat-menu-item-with-icon-leading-spacing, 12px)}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color, var(--mat-sys-on-surface))}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item:focus{outline:0}.mat-mdc-menu-item .mat-icon{flex-shrink:0;margin-right:var(--mat-menu-item-spacing, 12px);height:var(--mat-menu-item-icon-size, 24px);width:var(--mat-menu-item-icon-size, 24px)}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:var(--mat-menu-item-spacing, 12px)}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent))}@media(forced-colors: active){.mat-mdc-menu-item{margin-top:1px}}.mat-mdc-menu-submenu-icon{width:var(--mat-menu-item-icon-size, 24px);height:10px;fill:currentColor;padding-left:var(--mat-menu-item-spacing, 12px)}[dir=rtl] .mat-mdc-menu-submenu-icon{padding-right:var(--mat-menu-item-spacing, 12px);padding-left:0}[dir=rtl] .mat-mdc-menu-submenu-icon polygon{transform:scaleX(-1);transform-origin:center}@media(forced-colors: active){.mat-mdc-menu-submenu-icon{fill:CanvasText}}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}
`],encapsulation:2,changeDetection:0})}return a})(),sn=new q("mat-menu-scroll-strategy",{providedIn:"root",factory:()=>{let a=g(ae);return()=>a.scrollStrategies.reposition()}});function Tn(a){return()=>a.scrollStrategies.reposition()}var On={provide:sn,deps:[ae],useFactory:Tn},kn={passive:!0};var L=new WeakMap,ln=(()=>{class a{_overlay=g(ae);_element=g(Y);_viewContainerRef=g(qe);_menuItemInstance=g(B,{optional:!0,self:!0});_dir=g(at,{optional:!0});_focusMonitor=g(he);_ngZone=g(Ie);_scrollStrategy=g(sn);_changeDetectorRef=g(Z);_cleanupTouchstart;_portal;_overlayRef=null;_menuOpen=!1;_closingActionsSubscription=N.EMPTY;_hoverSubscription=N.EMPTY;_menuCloseSubscription=N.EMPTY;_pendingRemoval;_parentMaterialMenu;_parentInnerPadding;_openedBy=void 0;get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(e){this.menu=e}get menu(){return this._menu}set menu(e){e!==this._menu&&(this._menu=e,this._menuCloseSubscription.unsubscribe(),e&&(this._parentMaterialMenu,this._menuCloseSubscription=e.close.subscribe(t=>{this._destroyMenu(t),(t==="click"||t==="tab")&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(t)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}_menu;menuData;restoreFocus=!0;menuOpened=new H;onMenuOpen=this.menuOpened;menuClosed=new H;onMenuClose=this.menuClosed;constructor(){let e=g(ve,{optional:!0}),t=g(Ae);this._parentMaterialMenu=e instanceof A?e:void 0,this._cleanupTouchstart=et(t,this._element.nativeElement,"touchstart",n=>{Je(n)||(this._openedBy="touch")},kn)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this.menu&&this._ownsMenu(this.menu)&&L.delete(this.menu),this._cleanupTouchstart(),this._pendingRemoval?.unsubscribe(),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe(),this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null)}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){let e=this.menu;if(this._menuOpen||!e)return;this._pendingRemoval?.unsubscribe();let t=L.get(e);L.set(e,this),t&&t!==this&&t.closeMenu();let n=this._createOverlay(e),l=n.getConfig(),d=l.positionStrategy;this._setPosition(e,d),l.hasBackdrop=e.hasBackdrop==null?!this.triggersSubmenu():e.hasBackdrop,n.hasAttached()||(n.attach(this._getPortal(e)),e.lazyContent?.attach(this.menuData)),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),e.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,e.direction=this.dir,e.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0),e instanceof A&&(e._setIsOpen(!0),e._directDescendantItems.changes.pipe(Pe(e.close)).subscribe(()=>{d.withLockedPosition(!1).reapplyLastPosition(),d.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(e,t){this._focusMonitor&&e?this._focusMonitor.focusVia(this._element,e,t):this._element.nativeElement.focus(t)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(e){let t=this._overlayRef,n=this._menu;!t||!this.menuOpen||(this._closingActionsSubscription.unsubscribe(),this._pendingRemoval?.unsubscribe(),n instanceof A&&this._ownsMenu(n)?(this._pendingRemoval=n._animationDone.pipe(we(1)).subscribe(()=>{t.detach(),n.lazyContent?.detach()}),n._setIsOpen(!1)):(t.detach(),n?.lazyContent?.detach()),n&&this._ownsMenu(n)&&L.delete(n),this.restoreFocus&&(e==="keydown"||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,this._setIsMenuOpen(!1))}_setIsMenuOpen(e){e!==this._menuOpen&&(this._menuOpen=e,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(e),this._changeDetectorRef.markForCheck())}_createOverlay(e){if(!this._overlayRef){let t=this._getOverlayConfig(e);this._subscribeToPositions(e,t.positionStrategy),this._overlayRef=this._overlay.create(t),this._overlayRef.keydownEvents().subscribe(n=>{this.menu instanceof A&&this.menu._handleKeydown(n)})}return this._overlayRef}_getOverlayConfig(e){return new zt({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:e.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:e.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir||"ltr"})}_subscribeToPositions(e,t){e.setPositionClasses&&t.positionChanges.subscribe(n=>{this._ngZone.run(()=>{let l=n.connectionPair.overlayX==="start"?"after":"before",d=n.connectionPair.overlayY==="top"?"below":"above";e.setPositionClasses(l,d)})})}_setPosition(e,t){let[n,l]=e.xPosition==="before"?["end","start"]:["start","end"],[d,b]=e.yPosition==="above"?["bottom","top"]:["top","bottom"],[y,f]=[d,b],[O,I]=[n,l],T=0;if(this.triggersSubmenu()){if(I=n=e.xPosition==="before"?"start":"end",l=O=n==="end"?"start":"end",this._parentMaterialMenu){if(this._parentInnerPadding==null){let Ce=this._parentMaterialMenu.items.first;this._parentInnerPadding=Ce?Ce._getHostElement().offsetTop:0}T=d==="bottom"?this._parentInnerPadding:-this._parentInnerPadding}}else e.overlapTrigger||(y=d==="top"?"bottom":"top",f=b==="top"?"bottom":"top");t.withPositions([{originX:n,originY:y,overlayX:O,overlayY:d,offsetY:T},{originX:l,originY:y,overlayX:I,overlayY:d,offsetY:T},{originX:n,originY:f,overlayX:O,overlayY:b,offsetY:-T},{originX:l,originY:f,overlayX:I,overlayY:b,offsetY:-T}])}_menuClosingActions(){let e=this._overlayRef.backdropClick(),t=this._overlayRef.detachments(),n=this._parentMaterialMenu?this._parentMaterialMenu.closed:ge(),l=this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(ye(d=>this._menuOpen&&d!==this._menuItemInstance)):ge();return j(e,n,l,t)}_handleMousedown(e){Ke(e)||(this._openedBy=e.button===0?"mouse":void 0,this.triggersSubmenu()&&e.preventDefault())}_handleKeydown(e){let t=e.keyCode;(t===13||t===32)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(t===39&&this.dir==="ltr"||t===37&&this.dir==="rtl")&&(this._openedBy="keyboard",this.openMenu())}_handleClick(e){this.triggersSubmenu()?(e.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){this.triggersSubmenu()&&this._parentMaterialMenu&&(this._hoverSubscription=this._parentMaterialMenu._hovered().subscribe(e=>{e===this._menuItemInstance&&!e.disabled&&(this._openedBy="mouse",this.openMenu())}))}_getPortal(e){return(!this._portal||this._portal.templateRef!==e.templateRef)&&(this._portal=new Bt(e.templateRef,this._viewContainerRef)),this._portal}_ownsMenu(e){return L.get(e)===this}static \u0275fac=function(t){return new(t||a)};static \u0275dir=Re({type:a,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],hostVars:3,hostBindings:function(t,n){t&1&&_("click",function(d){return n._handleClick(d)})("mousedown",function(d){return n._handleMousedown(d)})("keydown",function(d){return n._handleKeydown(d)}),t&2&&Q("aria-haspopup",n.menu?"menu":null)("aria-expanded",n.menuOpen)("aria-controls",n.menuOpen?n.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:[0,"mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:[0,"matMenuTriggerFor","menu"],menuData:[0,"matMenuTriggerData","menuData"],restoreFocus:[0,"matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"},exportAs:["matMenuTrigger"]})}return a})(),cn=(()=>{class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=Qe({type:a});static \u0275inj=Te({providers:[On],imports:[ct,xe,jt,Nt,xe]})}return a})(),dn={transformMenu:{type:7,name:"transformMenu",definitions:[{type:0,name:"void",styles:{type:6,styles:{opacity:0,transform:"scale(0.8)"},offset:null}},{type:1,expr:"void => enter",animation:{type:4,styles:{type:6,styles:{opacity:1,transform:"scale(1)"},offset:null},timings:"120ms cubic-bezier(0, 0, 0.2, 1)"},options:null},{type:1,expr:"* => void",animation:{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"100ms 25ms linear"},options:null}],options:{}},fadeInItems:{type:7,name:"fadeInItems",definitions:[{type:0,name:"showing",styles:{type:6,styles:{opacity:1},offset:null}},{type:1,expr:"void => *",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:null,timings:"400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"}],options:null}],options:{}}},ao=dn.fadeInItems,ro=dn.transformMenu;var qn=()=>({standalone:!0});function Qn(a,i){a&1&&(r(0,"mat-error"),s(1," Title is required "),o())}function Rn(a,i){a&1&&(r(0,"mat-error"),s(1," Start time must be at least 5 minutes from now "),o())}function Un(a,i){a&1&&(r(0,"mat-error"),s(1," Start time is required "),o())}function Vn(a,i){a&1&&(r(0,"mat-error"),s(1," Duration is required "),o())}function Ln(a,i){a&1&&(r(0,"mat-error"),s(1," Duration must be at least 1 minute "),o())}function Bn(a,i){a&1&&(r(0,"mat-error"),s(1," Marks per question is required "),o())}function Nn(a,i){a&1&&(r(0,"mat-error"),s(1," Marks must be at least 1 "),o())}function zn(a,i){a&1&&(r(0,"mat-error"),s(1," Negative marks cannot be negative "),o())}function jn(a,i){if(a&1){let e=M();r(0,"button",41),_("click",function(){h(e);let n=m(2);return x(n.toggleSelectAll())}),r(1,"mat-icon"),s(2),o(),s(3),o()}if(a&2){let e=m(2);c(2),w(e.selectAllChecked()?"check_box":"check_box_outline_blank"),c(),v(" ",e.selectAllChecked()?"Deselect All":"Select All"," ")}}function $n(a,i){if(a&1){let e=M();r(0,"div",36)(1,"button",37),_("click",function(){h(e);let n=m();return x(n.toggleAddByUid())}),r(2,"mat-icon"),s(3,"add"),o(),s(4," Add By UID "),o(),r(5,"button",38),_("click",function(){h(e);let n=m();return x(n.toggleTagFilter())}),r(6,"mat-icon"),s(7,"filter_list"),o(),s(8),o(),r(9,"span",39),s(10),o(),u(11,jn,4,2,"button",40),o()}if(a&2){let e=m();c(8),v(" ",e.currentFilterTag()?"Filtered: "+e.currentFilterTag():"Filter by Tag"," "),c(2),v(" Total Available: ",e.availableQuestions().length," "),c(),p("ngIf",e.availableQuestions().length>0)}}function Hn(a,i){a&1&&(r(0,"div",52),P(1,"mat-spinner",53),r(2,"p"),s(3,"Loading tags..."),o()())}function Yn(a,i){if(a&1){let e=M();r(0,"button",56),_("click",function(){let n=h(e).$implicit,l=m(3);return x(l.applyTagFilter(n))}),r(1,"span",57),s(2),o(),r(3,"span",58),s(4),o()()}if(a&2){let e=i.$implicit,t=m(3);F("active",t.currentFilterTag()===e.tag),c(2),w(e.tag),c(2),w(e.questionCount)}}function Gn(a,i){if(a&1&&(r(0,"div",54),u(1,Yn,5,4,"button",55),o()),a&2){let e=m(2);c(),p("ngForOf",e.tags())}}function Wn(a,i){a&1&&(r(0,"div",59)(1,"mat-icon"),s(2,"label_off"),o(),r(3,"p"),s(4,"No tags available"),o()())}function Xn(a,i){if(a&1){let e=M();r(0,"div",42)(1,"div",43)(2,"h4",44),s(3,"Filter Questions by Tag"),o(),r(4,"div",45)(5,"button",46),_("click",function(){h(e);let n=m();return x(n.clearTagFilter())}),r(6,"mat-icon"),s(7,"clear"),o(),s(8," Clear Filter "),o(),r(9,"button",47),_("click",function(){h(e);let n=m();return x(n.toggleTagFilter())}),r(10,"mat-icon"),s(11,"close"),o(),s(12," Close "),o()()(),r(13,"div",48),u(14,Hn,4,0,"div",49)(15,Gn,2,1,"div",50)(16,Wn,5,0,"div",51),o()()}if(a&2){let e=m();c(14),p("ngIf",e.tagsLoading()),c(),p("ngIf",!e.tagsLoading()&&e.tags().length>0),c(),p("ngIf",!e.tagsLoading()&&e.tags().length===0)}}function Zn(a,i){if(a&1){let e=M();r(0,"button",74),_("click",function(){h(e);let n=m(3);return x(n.addUid())}),r(1,"mat-icon"),s(2,"add"),o()()}}function Kn(a,i){if(a&1){let e=M();r(0,"button",75),_("click",function(){h(e);let n=m(3);return x(n.processUids())}),r(1,"mat-icon"),s(2,"done"),o()()}}function Jn(a,i){if(a&1){let e=M();r(0,"button",76),_("click",function(){h(e);let n=m().index,l=m(2);return x(l.removeUidInput(n))}),r(1,"mat-icon"),s(2,"close"),o()()}}function ei(a,i){if(a&1&&(r(0,"div",77)(1,"mat-icon"),s(2),o(),r(3,"span"),s(4),o()()),a&2){let e=m().$implicit;G(e.status),c(2),w(e.status==="loading"?"hourglass_empty":e.status==="success"?"check_circle":e.status==="error"?"error":""),c(2),w(e.message)}}function ti(a,i){if(a&1){let e=M();r(0,"div",65)(1,"div",66)(2,"mat-icon",67),s(3,"fingerprint"),o(),r(4,"input",68),je("ngModelChange",function(n){let l=h(e).$implicit;return ze(l.value,n)||(l.value=n),x(n)}),_("input",function(n){let l=h(e).index,d=m(2);return x(d.onUidInputChange(l,n))})("keyup.enter",function(){h(e);let n=m(2);return x(n.addUid())}),o(),r(5,"div",69),u(6,Zn,3,0,"button",70)(7,Kn,3,0,"button",71)(8,Jn,3,0,"button",72),o()(),u(9,ei,5,4,"div",73),o()}if(a&2){let e=i.$implicit,t=i.index,n=m(2);c(4),Ne("ngModel",e.value),p("ngModelOptions",He(6,qn)),c(2),p("ngIf",t===n.uidInputs().length-1&&e.value.trim()),c(),p("ngIf",t===n.uidInputs().length-1&&e.value.trim()),c(),p("ngIf",n.uidInputs().length>1),c(),p("ngIf",e.status)}}function ni(a,i){if(a&1){let e=M();r(0,"div",60)(1,"div",61),u(2,ti,10,7,"div",62),o(),r(3,"div",63)(4,"button",64),_("click",function(){h(e);let n=m();return x(n.clearUids())}),r(5,"mat-icon"),s(6,"clear_all"),o(),s(7," Clear All "),o(),r(8,"button",46),_("click",function(){h(e);let n=m();return x(n.toggleAddByUid())}),r(9,"mat-icon"),s(10,"close"),o(),s(11," Close "),o()()()}if(a&2){let e=m();c(2),p("ngForOf",e.uidInputs())}}function ii(a,i){if(a&1&&(r(0,"span",78),s(1),o()),a&2){let e=m();c(),v(" (Filtered by: ",e.currentFilterTag(),") ")}}function oi(a,i){if(a&1&&(r(0,"mat-option",79)(1,"div",80)(2,"div",81),s(3),o(),r(4,"div",82)(5,"span",83),s(6),o(),r(7,"span",84),s(8),o(),r(9,"span",85),s(10),o()()()()),a&2){let e=i.$implicit,t=m();p("value",e.uid),c(3),v(" ",t.getQuestionDisplayText(e)," "),c(3),v(" Correct: ",t.getOptionLetter(e.correctAnswer)," "),c(2),v(" Tags: ",t.getQuestionTags(e)," "),c(2),v(" ID: ",e.uid.slice(0,8),"... ")}}function ai(a,i){a&1&&(r(0,"mat-error"),s(1," At least one question is required "),o())}function ri(a,i){a&1&&(r(0,"div",86),P(1,"mat-spinner",53),r(2,"p"),s(3,"Loading questions..."),o()())}function si(a,i){if(a&1){let e=M();r(0,"button",93),_("click",function(){h(e);let n=m(2);return x(n.clearAll())}),r(1,"mat-icon"),s(2,"clear_all"),o(),s(3," Clear All "),o()}}function li(a,i){if(a&1&&(r(0,"span",109)(1,"mat-icon"),s(2,"label"),o(),s(3),o()),a&2){let e=m().$implicit,t=m(2);c(3),v(" ",t.getQuestionTags(e)," ")}}function ci(a,i){if(a&1&&(r(0,"div",110)(1,"strong"),s(2,"Description:"),o(),r(3,"p"),s(4),o()()),a&2){let e=m().$implicit;c(4),w(e.description==null?null:e.description.english)}}function di(a,i){if(a&1&&(r(0,"div",110)(1,"strong"),s(2,"Description:"),o(),r(3,"p"),s(4),o()()),a&2){let e=m(2).$implicit;c(4),w(e.description==null?null:e.description.hindi)}}function mi(a,i){if(a&1&&(r(0,"div",103)(1,"strong"),s(2,"Hindi:"),o(),r(3,"p",81),s(4),o(),u(5,di,5,1,"div",104),o()),a&2){let e=m().$implicit;c(4),w(e.question.hindi),c(),p("ngIf",e.description==null?null:e.description.hindi)}}function pi(a,i){if(a&1&&(r(0,"div",116),s(1),o()),a&2){let e=m().$implicit;c(),w(e.hindi)}}function ui(a,i){if(a&1&&(r(0,"div",111)(1,"span",112),s(2),o(),r(3,"div",113)(4,"div",114),s(5),o(),u(6,pi,2,1,"div",115),o()()),a&2){let e=i.$implicit,t=i.index,n=m(3);c(2),w(n.getOptionLetter(t)),c(3),w(e.english),c(),p("ngIf",e.hindi)}}function gi(a,i){if(a&1){let e=M();r(0,"div",94)(1,"div",95)(2,"div",96)(3,"h5",97),s(4),o(),r(5,"span",98),s(6),o(),r(7,"span",99),s(8),o(),u(9,li,4,1,"span",100),o(),r(10,"button",101),_("click",function(){let n=h(e).index,l=m(2);return x(l.removeQuestion(n))}),r(11,"mat-icon"),s(12,"delete"),o()()(),r(13,"div",102)(14,"div",103)(15,"strong"),s(16,"English:"),o(),r(17,"p",81),s(18),o(),u(19,ci,5,1,"div",104),o(),u(20,mi,6,2,"div",105),r(21,"div",106)(22,"strong"),s(23,"Options:"),o(),r(24,"div",107),u(25,ui,7,3,"div",108),o()()()()}if(a&2){let e=i.$implicit,t=i.index,n=m(2);c(4),v("Question ",t+1,""),c(2),v(" Correct: ",n.getOptionLetter(e.correctAnswer)," "),c(2),v(" UID: ",e.uid," "),c(),p("ngIf",e.tags&&e.tags.length>0),c(9),w(e.question.english),c(),p("ngIf",e.description==null?null:e.description.english),c(),p("ngIf",e.question.hindi),c(5),p("ngForOf",e.options)}}function fi(a,i){if(a&1&&(r(0,"div",87)(1,"div",88)(2,"h4",89),s(3),o(),u(4,si,4,0,"button",90),o(),r(5,"div",91),u(6,gi,26,8,"div",92),o()()),a&2){let e=m();c(3),v("Selected Questions Preview (",e.selectedQuestions().length,")"),c(),p("ngIf",e.selectedQuestions().length>0),c(2),p("ngForOf",e.selectedQuestions())}}function _i(a,i){if(a&1&&(r(0,"p"),s(1),o()),a&2){let e=m(2);c(),v('No questions with tag "',e.currentFilterTag(),'" found.')}}function hi(a,i){a&1&&(r(0,"p"),s(1,"Select questions from the dropdown above to add them to your test."),o())}function xi(a,i){if(a&1&&(r(0,"div",117)(1,"mat-icon",118),s(2,"help_outline"),o(),r(3,"h4"),s(4,"No questions selected"),o(),u(5,_i,2,1,"p",12)(6,hi,2,0,"p",12),o()),a&2){let e=m();c(5),p("ngIf",e.currentFilterTag()),c(),p("ngIf",!e.currentFilterTag())}}function bi(a,i){a&1&&P(0,"mat-spinner",119)}function vi(a,i){if(a&1&&(r(0,"span"),s(1),o()),a&2){let e=m();c(),Be(" ",e.isEdit()?"Update":"Create"," Test (",e.selectedQuestions().length," questions) ")}}var ue=class a{fb=g(Mt);testService=g(me);questionService=g(nn);snackBar=g(re);dialogRef=g($t);data=g(Ht);testForm;isEdit=C(!1);loading=C(!1);questionsLoading=C(!1);allQuestions=C([]);availableQuestions=C([]);selectedQuestions=C([]);filteredQuestions=C([]);tags=C([]);tagsLoading=C(!1);currentFilterTag=C(null);showTagFilter=C(!1);showAddByUid=C(!1);uidInputs=C([{value:""}]);questionSearchControl=new gt("");selectAllChecked=C(!1);constructor(){this.testForm=this.createTestForm(),this.isEdit.set(!!this.data.test)}setDefaultDateTime(){let i=new Date,e=new Date(i.getTime()+60*60*1e3),t=this.formatDateTimeForInput(e);this.testForm.patchValue({startTime:t})}formatDateTimeForInput(i){let e=i.getFullYear(),t=this.padZero(i.getMonth()+1),n=this.padZero(i.getDate()),l=this.padZero(i.getHours()),d=this.padZero(i.getMinutes());return`${e}-${t}-${n}T${l}:${d}`}getMinDateTime(){return this.formatDateTimeForInput(new Date)}padZero(i){return i.toString().padStart(2,"0")}futureDateValidator(i){if(!i.value)return null;let e=new Date(i.value),t=new Date,n=new Date(t.getTime()+5*60*1e3);return e<n?{pastDate:"Start time must be at least 5 minutes from now"}:null}onDateTimeChange(){if(this.testForm.get("startTime")?.errors?.pastDate){this.snackBar.open("Start time must be at least 5 minutes from now","Close",{duration:3e3});let e=new Date(new Date().getTime()+5*60*1e3);this.testForm.patchValue({startTime:this.formatDateTimeForInput(e)})}}createTestForm(){return this.fb.group({title:["",k.required],description:[""],startTime:["",[k.required,this.futureDateValidator.bind(this)]],duration:["",[k.required,k.min(1)]],marksPerQuestion:[1,[k.required,k.min(1)]],negativeMarks:[0,[k.min(0)]],selectedQuestionUids:[[],k.required]})}ngOnInit(){this.loadAvailableQuestions().then(()=>{this.isEdit()?this.populateForm(this.data.test):this.setDefaultDateTime()}),this.loadTags()}loadAvailableQuestions(){return new Promise((i,e)=>{this.questionsLoading.set(!0),this.questionService.getAllQuestions().subscribe({next:t=>{let n=(t.questions||[]).map(l=>({_id:l._id,uid:l.uid,question:{english:l.question?.english||"",hindi:l.question?.hindi||"",_id:l.question?._id},options:l.options||[],correctAnswer:l.correctAnswer,description:l.description,tags:l.tags||[],isActive:l.isActive!==void 0?l.isActive:!0,createdAt:l.createdAt,updatedAt:l.updatedAt}));this.allQuestions.set(n),this.availableQuestions.set(n),this.filteredQuestions.set(n),this.questionsLoading.set(!1),i()},error:t=>{console.error("Error loading questions:",t),this.snackBar.open("Error loading questions","Close",{duration:3e3}),this.questionsLoading.set(!1),e(t)}})})}populateForm(i){console.log("Populating form with test data:",i);let e=new Date(i.startTime),t=this.formatDateTimeForInput(e),n=i.questionUids||[];this.testForm.patchValue({title:i.title,description:i.description,startTime:t,duration:i.duration,marksPerQuestion:i.marksPerQuestion||1,negativeMarks:i.negativeMarks||0,selectedQuestionUids:n}),this.setSelectedQuestionsFromUids(n)}setSelectedQuestionsFromUids(i){if(i.length>0){let t=this.allQuestions().filter(b=>i.includes(b.uid));console.log("Setting selected questions:",t),this.selectedQuestions.set(t);let n=this.filteredQuestions(),l=n.map(b=>b.uid),d=t.filter(b=>l.includes(b.uid));this.selectAllChecked.set(d.length===n.length)}}loadTags(){this.tagsLoading.set(!0),this.questionService.getTags().subscribe({next:i=>{let e=(i||[]).map(t=>({_id:t._id,tag:t.tag,questionCount:0}));this.calculateTagQuestionCounts(e),this.tags.set(e),this.tagsLoading.set(!1)},error:i=>{console.error("Error loading tags:",i),this.tagsLoading.set(!1)}})}calculateTagQuestionCounts(i){let e=this.allQuestions(),t=new Map;i.forEach(l=>{t.set(l._id,l)}),i.forEach(l=>{let d=e.filter(b=>b.tags.includes(l._id)).length;l.questionCount=d});let n=e.filter(l=>!l.tags||l.tags.length===0);n.length>0&&i.push({_id:"none",tag:"None",questionCount:n.length})}toggleTagFilter(){this.showTagFilter.set(!this.showTagFilter())}applyTagFilter(i){this.currentFilterTag.set(i.tag),this.showTagFilter.set(!1);let e=this.allQuestions(),t;i._id==="none"?t=e.filter(d=>!d.tags||d.tags.length===0):t=e.filter(d=>d.tags&&d.tags.includes(i._id)),this.filteredQuestions.set(t),this.availableQuestions.set(t);let n=this.testForm.get("selectedQuestionUids")?.value||[],l=this.allQuestions().filter(d=>n.includes(d.uid));this.selectedQuestions.set(l),this.snackBar.open(`Filtered by tag: ${i.tag} (${t.length} questions)`,"Close",{duration:3e3})}clearTagFilter(){this.currentFilterTag.set(null),this.showTagFilter.set(!1),this.filteredQuestions.set(this.allQuestions()),this.availableQuestions.set(this.allQuestions());let i=this.testForm.get("selectedQuestionUids")?.value||[],e=this.allQuestions().filter(t=>i.includes(t.uid));this.selectedQuestions.set(e),this.snackBar.open("Tag filter cleared","Close",{duration:2e3})}getQuestionTags(i){if(!i.tags||i.tags.length===0)return"None";let e=this.tags(),t=i.tags.map(n=>{let l=e.find(d=>d._id===n);return l?l.tag:"Unknown"}).filter(n=>n!=="Unknown");return t.length>0?t.join(", "):"None"}toggleAddByUid(){this.showAddByUid.set(!this.showAddByUid()),this.showAddByUid()||this.uidInputs.set([{value:""}])}onUidInputChange(i,e){let t=e.target.value;this.uidInputs.update(n=>(n[i]=E(S({},n[i]),{value:t,status:null,message:void 0}),[...n]))}addUid(){let i=this.uidInputs();if(!i[i.length-1].value.trim()){this.snackBar.open("Please enter a UID before adding another","Close",{duration:2e3});return}this.uidInputs.update(t=>[...t,{value:""}])}removeUidInput(i){this.uidInputs.update(e=>(e.splice(i,1),[...e]))}clearUids(){this.uidInputs.set([{value:""}])}processUids(){return Me(this,null,function*(){let e=this.uidInputs().map(t=>t.value.trim()).filter(t=>t.length>0);if(e.length===0){this.snackBar.open("Please enter at least one UID","Close",{duration:2e3});return}this.uidInputs.update(t=>t.map(n=>E(S({},n),{status:"loading",message:"Processing..."})));try{let t=this.allQuestions(),n=[],l=[];if(e.forEach((d,b)=>{let y=t.find(f=>f.uid===d);y?(n.push(y),this.uidInputs.update(f=>(f[b]=E(S({},f[b]),{status:"success",message:"Question found"}),[...f]))):(l.push(d),this.uidInputs.update(f=>(f[b]=E(S({},f[b]),{status:"error",message:"Question not found"}),[...f])))}),n.length>0){let d=this.testForm.get("selectedQuestionUids")?.value||[],b=n.map(T=>T.uid),y=[...new Set([...d,...b])];this.testForm.patchValue({selectedQuestionUids:y}),this.setSelectedQuestionsFromUids(y);let f=this.filteredQuestions(),O=f.map(T=>T.uid),I=y.filter(T=>O.includes(T));this.selectAllChecked.set(I.length===f.length),this.snackBar.open(`Added ${n.length} question(s). ${l.length>0?l.length+" not found.":""}`,"Close",{duration:3e3}),setTimeout(()=>{this.showAddByUid.set(!1),this.uidInputs.set([{value:""}])},1e3)}else this.snackBar.open("No questions found with the provided UIDs","Close",{duration:3e3})}catch(t){console.error("Error processing UIDs:",t),this.snackBar.open("Error processing UIDs","Close",{duration:3e3})}})}onQuestionSelectionChange(i){this.setSelectedQuestionsFromUids(i)}toggleSelectAll(){let i=this.testForm.get("selectedQuestionUids")?.value||[],t=this.filteredQuestions().map(l=>l.uid);if(t.every(l=>i.includes(l))){let l=i.filter(d=>!t.includes(d));this.testForm.patchValue({selectedQuestionUids:l}),this.setSelectedQuestionsFromUids(l),this.selectAllChecked.set(!1)}else{let l=[...new Set([...i,...t])];this.testForm.patchValue({selectedQuestionUids:l}),this.setSelectedQuestionsFromUids(l),this.selectAllChecked.set(!0)}}clearAll(){this.testForm.patchValue({selectedQuestionUids:[]}),this.selectedQuestions.set([]),this.selectAllChecked.set(!1),this.snackBar.open("All questions cleared","Close",{duration:2e3})}removeQuestion(i){let e=[...this.selectedQuestions()],t=e[i];e.splice(i,1),this.selectedQuestions.set(e);let l=(this.testForm.get("selectedQuestionUids")?.value||[]).filter(f=>f!==t.uid);this.testForm.patchValue({selectedQuestionUids:l});let d=this.filteredQuestions(),b=d.map(f=>f.uid),y=l.filter(f=>b.includes(f));this.selectAllChecked.set(y.length===d.length),this.snackBar.open("Question removed from test","Close",{duration:2e3})}getQuestionDisplayText(i){let e=i.question.english;return e.length>100?e.substring(0,100)+"...":e}getOptionLetter(i){return String.fromCharCode(65+i)}onSubmit(){if(this.testForm.valid&&this.selectedQuestions().length>0){this.loading.set(!0);let i=this.testForm.value,e={title:i.title,description:i.description,startTime:new Date(i.startTime).toISOString(),duration:i.duration,marksPerQuestion:i.marksPerQuestion,negativeMarks:i.negativeMarks,questionUids:i.selectedQuestionUids};console.log("Submitting test data:",e),(this.isEdit()?this.testService.updateTest(this.data.test._id,e):this.testService.createTest(e)).subscribe({next:()=>{this.snackBar.open(`Test ${this.isEdit()?"updated":"created"} successfully`,"Close",{duration:3e3}),this.dialogRef.close(!0)},error:n=>{this.loading.set(!1),console.error("Error:",n),this.snackBar.open(`Error ${this.isEdit()?"updating":"creating"} test: ${n.error?.message||"Unknown error"}`,"Close",{duration:3e3})},complete:()=>{this.loading.set(!1)}})}else this.selectedQuestions().length===0?this.snackBar.open("Please select at least one question","Close",{duration:3e3}):this.snackBar.open("Please fill all required fields","Close",{duration:3e3})}onCancel(){this.dialogRef.close(!1)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=D({type:a,selectors:[["app-create-test-dialog"]],decls:89,vars:24,consts:[[1,"create-test-dialog"],[1,"dialog-header"],["mat-dialog-title",""],["mat-icon-button","",1,"close-button",3,"click"],[1,"dialog-content"],[1,"test-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-grid"],["appearance","outline",1,"full-width"],["matInput","","formControlName","title","placeholder","Enter test title"],["matSuffix",""],[4,"ngIf"],["matInput","","formControlName","description","placeholder","Enter test description","rows","3"],[1,"row"],["appearance","outline",1,"half-width"],["matInput","","type","datetime-local","formControlName","startTime","required","",3,"change","min"],["matInput","","type","number","formControlName","duration","min","1"],[1,"marks-section"],["matInput","","type","number","formControlName","marksPerQuestion","min","1"],["matInput","","type","number","formControlName","negativeMarks","min","0","step","0.25"],[1,"questions-section"],[1,"section-header"],["class","action-buttons",4,"ngIf"],["class","filter-by-tag-section",4,"ngIf"],["class","add-by-uid-section",4,"ngIf"],[1,"questions-select-section"],["class","filter-indicator",4,"ngIf"],["formControlName","selectedQuestionUids","multiple","",3,"selectionChange"],["class","question-option",3,"value",4,"ngFor","ngForOf"],["class","questions-loading",4,"ngIf"],["class","selected-questions-preview",4,"ngIf"],["class","no-questions-selected",4,"ngIf"],["align","end",1,"dialog-actions"],["mat-raised-button","","color","primary",1,"submit-btn",3,"click","disabled"],["diameter","20",4,"ngIf"],[1,"action-buttons"],["type","button","mat-stroked-button","","color","accent",1,"add-by-uid-btn",3,"click"],["type","button","mat-stroked-button","","color","primary",1,"filter-by-tag-btn",3,"click"],[1,"total-questions"],["type","button","mat-stroked-button","","color","primary","class","select-all-btn",3,"click",4,"ngIf"],["type","button","mat-stroked-button","","color","primary",1,"select-all-btn",3,"click"],[1,"filter-by-tag-section"],[1,"filter-header"],[1,"filter-title"],[1,"filter-actions"],["type","button","mat-stroked-button","","color","warn",3,"click"],["type","button","mat-stroked-button","","color","primary",3,"click"],[1,"tags-container"],["class","tags-loading",4,"ngIf"],["class","tags-grid",4,"ngIf"],["class","no-tags",4,"ngIf"],[1,"tags-loading"],["diameter","30"],[1,"tags-grid"],["type","button","mat-stroked-button","","class","tag-button",3,"active","click",4,"ngFor","ngForOf"],["type","button","mat-stroked-button","",1,"tag-button",3,"click"],[1,"tag-name"],[1,"tag-count"],[1,"no-tags"],[1,"add-by-uid-section"],[1,"uid-inputs-container"],["class","uid-input-row",4,"ngFor","ngForOf"],[1,"uid-section-actions"],["type","button","mat-stroked-button","",3,"click"],[1,"uid-input-row"],[1,"uid-input-wrapper"],[1,"uid-input-icon"],["type","text","placeholder","Enter Question UID",1,"uid-input",3,"ngModelChange","input","keyup.enter","ngModel","ngModelOptions"],[1,"uid-actions"],["type","button","mat-icon-button","","color","primary","class","uid-action-btn","matTooltip","Add another UID",3,"click",4,"ngIf"],["type","button","mat-icon-button","","color","accent","class","uid-action-btn","matTooltip","Process UIDs",3,"click",4,"ngIf"],["type","button","mat-icon-button","","color","warn","class","uid-action-btn","matTooltip","Remove this UID",3,"click",4,"ngIf"],["class","uid-status",3,"class",4,"ngIf"],["type","button","mat-icon-button","","color","primary","matTooltip","Add another UID",1,"uid-action-btn",3,"click"],["type","button","mat-icon-button","","color","accent","matTooltip","Process UIDs",1,"uid-action-btn",3,"click"],["type","button","mat-icon-button","","color","warn","matTooltip","Remove this UID",1,"uid-action-btn",3,"click"],[1,"uid-status"],[1,"filter-indicator"],[1,"question-option",3,"value"],[1,"question-option-content"],[1,"question-text"],[1,"question-meta"],[1,"correct-answer"],[1,"question-tags"],[1,"question-id"],[1,"questions-loading"],[1,"selected-questions-preview"],[1,"preview-header-section"],[1,"preview-title"],["type","button","mat-stroked-button","","color","warn","class","clear-all-btn",3,"click",4,"ngIf"],[1,"questions-preview-list"],["class","question-preview-card",4,"ngFor","ngForOf"],["type","button","mat-stroked-button","","color","warn",1,"clear-all-btn",3,"click"],[1,"question-preview-card"],[1,"preview-header"],[1,"question-header-left"],[1,"question-preview-number"],[1,"correct-answer-badge"],[1,"question-uid-badge"],["class","question-tags-badge",4,"ngIf"],["type","button","mat-icon-button","","color","warn","matTooltip","Remove question from test",1,"delete-question-btn",3,"click"],[1,"preview-content"],[1,"language-preview"],["class","description-preview",4,"ngIf"],["class","language-preview",4,"ngIf"],[1,"options-preview"],[1,"options-grid"],["class","option-preview",4,"ngFor","ngForOf"],[1,"question-tags-badge"],[1,"description-preview"],[1,"option-preview"],[1,"option-letter"],[1,"option-content"],[1,"option-text"],["class","option-text-hindi",4,"ngIf"],[1,"option-text-hindi"],[1,"no-questions-selected"],[1,"no-questions-icon"],["diameter","20"]],template:function(e,t){if(e&1&&(r(0,"div",0)(1,"div",1)(2,"h2",2),s(3),o(),r(4,"button",3),_("click",function(){return t.onCancel()}),r(5,"mat-icon"),s(6,"close"),o()()(),r(7,"mat-dialog-content",4)(8,"form",5),_("ngSubmit",function(){return t.onSubmit()}),r(9,"div",6)(10,"h3",7),s(11,"Test Information"),o(),r(12,"div",8)(13,"mat-form-field",9)(14,"mat-label"),s(15,"Test Title"),o(),P(16,"input",10),r(17,"mat-icon",11),s(18,"title"),o(),u(19,Qn,2,0,"mat-error",12),o(),r(20,"mat-form-field",9)(21,"mat-label"),s(22,"Description"),o(),P(23,"textarea",13),r(24,"mat-icon",11),s(25,"description"),o()(),r(26,"div",14)(27,"mat-form-field",15)(28,"mat-label"),s(29,"Start Time"),o(),r(30,"input",16),_("change",function(){return t.onDateTimeChange()}),o(),r(31,"mat-icon",11),s(32,"schedule"),o(),r(33,"mat-hint"),s(34,"Must be at least 5 minutes from now"),o(),u(35,Rn,2,0,"mat-error",12)(36,Un,2,0,"mat-error",12),o(),r(37,"mat-form-field",15)(38,"mat-label"),s(39,"Duration (minutes)"),o(),P(40,"input",17),r(41,"mat-icon",11),s(42,"timer"),o(),u(43,Vn,2,0,"mat-error",12)(44,Ln,2,0,"mat-error",12),o()(),r(45,"div",18)(46,"mat-form-field",15)(47,"mat-label"),s(48,"Marks per Question"),o(),P(49,"input",19),r(50,"mat-icon",11),s(51,"grade"),o(),u(52,Bn,2,0,"mat-error",12)(53,Nn,2,0,"mat-error",12),o(),r(54,"mat-form-field",15)(55,"mat-label"),s(56,"Negative Marks per Question"),o(),P(57,"input",20),r(58,"mat-icon",11),s(59,"remove"),o(),r(60,"mat-hint"),s(61,"Enter 0 for no negative marking"),o(),u(62,zn,2,0,"mat-error",12),o()()()(),r(63,"div",21)(64,"div",22)(65,"h3",7),s(66),o(),u(67,$n,12,3,"div",23),o(),u(68,Xn,17,3,"div",24)(69,ni,12,1,"div",25),r(70,"div",26)(71,"mat-form-field",9)(72,"mat-label"),s(73,"Select Questions "),u(74,ii,2,1,"span",27),o(),r(75,"mat-select",28),_("selectionChange",function(l){return t.onQuestionSelectionChange(l.value)}),u(76,oi,11,5,"mat-option",29),o(),r(77,"mat-icon",11),s(78,"quiz"),o(),r(79,"mat-hint"),s(80,"Select one or more questions for this test"),o(),u(81,ai,2,0,"mat-error",12),o(),u(82,ri,4,0,"div",30),o(),u(83,fi,7,3,"div",31)(84,xi,7,2,"div",32),o()()(),r(85,"mat-dialog-actions",33)(86,"button",34),_("click",function(){return t.onSubmit()}),u(87,bi,1,0,"mat-spinner",35)(88,vi,2,2,"span",12),o()()()),e&2){let n,l,d,b,y,f,O,I,T;c(3),w(t.isEdit()?"Edit/View Test":"Create New Test"),c(5),p("formGroup",t.testForm),c(11),p("ngIf",(n=t.testForm.get("title"))==null?null:n.hasError("required")),c(11),p("min",t.getMinDateTime()),c(5),p("ngIf",(l=t.testForm.get("startTime"))==null?null:l.hasError("pastDate")),c(),p("ngIf",(d=t.testForm.get("startTime"))==null?null:d.hasError("required")),c(7),p("ngIf",(b=t.testForm.get("duration"))==null?null:b.hasError("required")),c(),p("ngIf",(y=t.testForm.get("duration"))==null?null:y.hasError("min")),c(8),p("ngIf",(f=t.testForm.get("marksPerQuestion"))==null?null:f.hasError("required")),c(),p("ngIf",(O=t.testForm.get("marksPerQuestion"))==null?null:O.hasError("min")),c(9),p("ngIf",(I=t.testForm.get("negativeMarks"))==null?null:I.hasError("min")),c(4),v("Select Questions (",t.selectedQuestions().length,")"),c(),p("ngIf",!t.questionsLoading()),c(),p("ngIf",t.showTagFilter()),c(),p("ngIf",t.showAddByUid()),c(5),p("ngIf",t.currentFilterTag()),c(2),p("ngForOf",t.filteredQuestions()),c(5),p("ngIf",(T=t.testForm.get("selectedQuestionUids"))==null?null:T.hasError("required")),c(),p("ngIf",t.questionsLoading()),c(),p("ngIf",t.selectedQuestions().length>0),c(),p("ngIf",t.selectedQuestions().length===0&&!t.questionsLoading()),c(2),p("disabled",!t.testForm.valid||t.selectedQuestions().length===0||t.loading()),c(),p("ngIf",t.loading()),c(),p("ngIf",!t.loading())}},dependencies:[ee,K,J,wt,_t,mt,ht,pt,ut,Ct,vt,xt,bt,yt,ft,de,Gt,Xt,Wt,Rt,Qt,Dt,At,Ft,qt,Vt,Ut,ne,te,Lt,Kt,Zt,lt,ce,le,se,oe,ie,tn,en],styles:['.questions-select-section[_ngcontent-%COMP%]{margin-bottom:20px}.questions-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;padding:20px;color:#666}.question-option-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.question-text[_ngcontent-%COMP%]{font-weight:500;margin-bottom:4px;line-height:1.3}.question-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.8em;color:#666}.correct-answer[_ngcontent-%COMP%]{color:#4caf50;font-weight:500}.question-id[_ngcontent-%COMP%]{font-family:monospace}.question-preview-card[_ngcontent-%COMP%]{padding:16px;background:#fff;border:1px solid #e0e0e0;border-radius:8px;box-shadow:0 1px 3px #0000001a}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #f0f0f0}.question-preview-number[_ngcontent-%COMP%]{margin:0;color:#3f51b5;font-weight:500}.correct-answer-badge[_ngcontent-%COMP%]{background:#4caf50;color:#fff;padding:4px 8px;border-radius:12px;font-size:.8em;font-weight:500}.preview-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.language-preview[_ngcontent-%COMP%]{padding:8px;background:#f8f9fa;border-radius:4px}.language-preview[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333;font-size:.9em}.question-text[_ngcontent-%COMP%]{margin:4px 0 0;color:#555;line-height:1.4}.description-preview[_ngcontent-%COMP%]{margin-top:8px;padding-top:8px;border-top:1px dashed #ddd}.description-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;color:#666;font-style:italic}.options-preview[_ngcontent-%COMP%]{margin-top:8px}.options-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}.option-preview[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:8px;background:#fff;border:1px solid #e0e0e0;border-radius:4px}.option-letter[_ngcontent-%COMP%]{background:#3f51b5;color:#fff;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.8em;font-weight:700;flex-shrink:0}.option-text[_ngcontent-%COMP%]{color:#333;font-size:.9em;line-height:1.3}.option-text-hindi[_ngcontent-%COMP%]{color:#666;font-size:.85em;line-height:1.3;margin-top:2px}.no-questions-selected[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;background:#fafafa;border:2px dashed #e0e0e0;border-radius:8px;color:#666}.no-questions-selected[_ngcontent-%COMP%]   .no-questions-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#ccc;margin-bottom:16px}.no-questions-selected[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#333}.total-questions[_ngcontent-%COMP%]{color:#666;font-size:.9em;padding:8px 12px;background:#f5f5f5;border-radius:4px}.questions-preview-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.questions-preview-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.questions-preview-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.questions-preview-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@media (max-width: 768px){.options-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.preview-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px}.question-meta[_ngcontent-%COMP%]{flex-direction:column;gap:4px}}.create-test-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:90vh}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px 0;border-bottom:1px solid #e0e0e0;background:#fff;position:sticky;top:0;z-index:10}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#3f51b5;font-weight:500}.close-button[_ngcontent-%COMP%]{margin-right:-8px}.dialog-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:0;margin:0}.test-form[_ngcontent-%COMP%]{padding:24px}.form-section[_ngcontent-%COMP%]{margin-bottom:32px;padding:24px;background:#fff;border-radius:12px;border:1px solid #e2e8f0;box-shadow:0 1px 3px #0000000d;transition:box-shadow .3s ease}.form-section[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000014}.section-title[_ngcontent-%COMP%]{margin:0 0 24px;color:#2d3748;font-size:1.3em;font-weight:600;display:flex;align-items:center;gap:12px;padding-bottom:12px;border-bottom:2px solid #e2e8f0}.section-title[_ngcontent-%COMP%]:before{content:"";width:4px;height:24px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:2px}.form-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.row[_ngcontent-%COMP%]{display:flex;gap:20px}.full-width[_ngcontent-%COMP%]{width:100%}.half-width[_ngcontent-%COMP%]{flex:1}.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{background:#f8fafc!important;border-radius:8px!important}.mat-mdc-form-field-focus-overlay[_ngcontent-%COMP%], .mat-mdc-form-field.mat-focused[_ngcontent-%COMP%]   .mat-mdc-form-field-focus-overlay[_ngcontent-%COMP%]{background:transparent!important}.marks-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px;padding-top:20px;border-top:1px solid #e2e8f0}.questions-section[_ngcontent-%COMP%]{margin-top:32px}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;flex-wrap:wrap;gap:16px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.total-questions[_ngcontent-%COMP%]{color:#4a5568;font-size:.9em;padding:8px 16px;background:#edf2f7;border-radius:8px;font-weight:500;border:1px solid #e2e8f0}.questions-select-section[_ngcontent-%COMP%]{margin-bottom:24px}.questions-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;padding:40px 20px;background:#f8fafc;border-radius:12px;color:#4a5568}.questions-loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-weight:500}.question-option-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;padding:8px 0}.question-text[_ngcontent-%COMP%]{font-weight:500;margin-bottom:6px;line-height:1.4;color:#2d3748}.question-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.8em;color:#718096}.correct-answer[_ngcontent-%COMP%]{color:#38a169;font-weight:600;background:#f0fff4;padding:2px 8px;border-radius:12px;border:1px solid #c6f6d5}.question-id[_ngcontent-%COMP%]{font-family:Monaco,Consolas,monospace;background:#edf2f7;padding:2px 6px;border-radius:4px}.question-preview-card[_ngcontent-%COMP%]{padding:20px;background:#fff;border:1px solid #e2e8f0;border-radius:12px;box-shadow:0 2px 8px #0000000f;transition:all .3s ease;position:relative;overflow:hidden}.question-preview-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:4px;height:100%;background:linear-gradient(135deg,#667eea,#764ba2)}.question-preview-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #0000001a;transform:translateY(-2px)}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #f1f5f9}.question-preview-number[_ngcontent-%COMP%]{margin:0;color:#2d3748;font-weight:600;font-size:1.1em}.correct-answer-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#48bb78,#38a169);color:#fff;padding:6px 12px;border-radius:20px;font-size:.8em;font-weight:600;box-shadow:0 2px 4px #48bb784d}.preview-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.language-preview[_ngcontent-%COMP%]{padding:16px;background:#f8fafc;border-radius:8px;border:1px solid #e2e8f0}.language-preview[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2d3748;font-size:.95em;font-weight:600;display:block;margin-bottom:8px}.question-text[_ngcontent-%COMP%]{margin:8px 0 0;color:#4a5568;line-height:1.5;font-size:.95em}.description-preview[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px dashed #cbd5e0}.description-preview[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#4a5568;font-size:.9em}.description-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:6px 0 0;color:#718096;font-style:italic;line-height:1.4;font-size:.9em}.options-preview[_ngcontent-%COMP%]{margin-top:12px}.options-preview[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2d3748;font-size:.95em;font-weight:600;display:block;margin-bottom:12px}.options-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:8px}.option-preview[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:12px;background:#fff;border:1px solid #e2e8f0;border-radius:8px;transition:all .2s ease}.option-preview[_ngcontent-%COMP%]:hover{border-color:#667eea;background:#f7fafc}.option-letter[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.8em;font-weight:700;flex-shrink:0;box-shadow:0 2px 4px #667eea4d}.option-content[_ngcontent-%COMP%]{flex:1}.option-text[_ngcontent-%COMP%]{color:#2d3748;font-size:.9em;line-height:1.4;font-weight:500}.option-text-hindi[_ngcontent-%COMP%]{color:#718096;font-size:.85em;line-height:1.4;margin-top:4px}.no-questions-selected[_ngcontent-%COMP%]{text-align:center;padding:60px 40px;background:linear-gradient(135deg,#f8fafc,#edf2f7);border:2px dashed #cbd5e0;border-radius:16px;color:#718096}.no-questions-selected[_ngcontent-%COMP%]   .no-questions-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#a0aec0;margin-bottom:20px;opacity:.7}.no-questions-selected[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#4a5568;font-size:1.3em;font-weight:600}.no-questions-selected[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em;max-width:400px;margin:0 auto;line-height:1.5}.dialog-actions[_ngcontent-%COMP%]{padding:20px 24px;border-top:1px solid #e2e8f0;background:#fff;position:sticky;bottom:0;gap:12px;box-shadow:0 -2px 8px #0000000d}.submit-btn[_ngcontent-%COMP%]{min-width:200px;height:48px;border-radius:8px;font-weight:600;font-size:1em;background:#add8e6;box-shadow:0 2px 8px #667eea4d;transition:all .3s ease}.submit-btn[_ngcontent-%COMP%]:hover:not([disabled]){transform:translateY(-1px);box-shadow:0 4px 12px #667eea66}.submit-btn[disabled][_ngcontent-%COMP%]{background:#cbd5e0;box-shadow:none;transform:none}.questions-preview-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.questions-preview-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:4px}.questions-preview-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e0;border-radius:4px}.questions-preview-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a0aec0}.mat-mdc-select-panel[_ngcontent-%COMP%]{border-radius:12px!important;box-shadow:0 4px 20px #00000026!important;border:1px solid #e2e8f0}.mat-mdc-option[_ngcontent-%COMP%]{border-bottom:1px solid #f1f5f9;transition:background-color .2s ease}.mat-mdc-option[_ngcontent-%COMP%]:hover:not(.mat-mdc-option-disabled){background:#f7fafc!important}.mat-mdc-option.mat-active[_ngcontent-%COMP%]{background:#edf2f7!important}@media (max-width: 768px){.create-test-dialog[_ngcontent-%COMP%]{max-height:95vh}.dialog-header[_ngcontent-%COMP%]{padding:16px 20px}.test-form[_ngcontent-%COMP%]{padding:16px}.form-section[_ngcontent-%COMP%]{padding:20px;margin-bottom:24px}.row[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.action-buttons[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}.options-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:10px}.preview-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:10px}.question-meta[_ngcontent-%COMP%]{flex-direction:column;gap:6px}.marks-section[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.dialog-actions[_ngcontent-%COMP%]{padding:16px 20px}.submit-btn[_ngcontent-%COMP%]{min-width:100%;height:44px}}@media (max-width: 480px){.questions-preview-list[_ngcontent-%COMP%]{max-height:400px}.question-preview-card[_ngcontent-%COMP%]{padding:16px}.no-questions-selected[_ngcontent-%COMP%]{padding:40px 20px}.no-questions-selected[_ngcontent-%COMP%]   .no-questions-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}}.question-preview-card[_ngcontent-%COMP%], .option-preview[_ngcontent-%COMP%], .form-section[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1)}.mat-mdc-form-field.mat-focused[_ngcontent-%COMP%]   .mat-mdc-form-field-focus-overlay[_ngcontent-%COMP%]{background:transparent}.mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-text-field--focused[_ngcontent-%COMP%]{background:#f7fafc!important}.select-all-btn[_ngcontent-%COMP%]{border-radius:8px;font-weight:500}.select-all-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.clear-all-btn[_ngcontent-%COMP%]{border-radius:8px;font-weight:500}.clear-all-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.question-header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex-wrap:wrap}.delete-question-btn[_ngcontent-%COMP%]{background:#f443361a;transition:all .3s ease}.delete-question-btn[_ngcontent-%COMP%]:hover{background:#f4433633;transform:scale(1.1)}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #f1f5f9;gap:16px}@media (max-width: 768px){.preview-header-section[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.question-header-left[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px}.preview-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.action-buttons[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.select-all-btn[_ngcontent-%COMP%], .clear-all-btn[_ngcontent-%COMP%]{width:100%;margin-top:8px}}.selection-count[_ngcontent-%COMP%]{background:#667eea;color:#fff;padding:4px 8px;border-radius:12px;font-size:.8em;font-weight:500;margin-left:8px}.selected-questions-preview[_ngcontent-%COMP%]{margin-top:32px;min-height:400px;display:flex;flex-direction:column}.questions-preview-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;flex:1;overflow-y:auto;padding-right:12px}.preview-header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:16px;flex-shrink:0}.add-by-uid-section[_ngcontent-%COMP%]{margin:24px 0;padding:24px;background:linear-gradient(135deg,#f8fafc,#edf2f7);border-radius:12px;border:2px solid #e2e8f0;box-shadow:0 2px 8px #0000000d}.uid-inputs-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;margin-bottom:20px}.uid-input-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.uid-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;background:#fff;border:2px solid #cbd5e0;border-radius:8px;padding:8px 16px;transition:all .3s ease}.uid-input-wrapper[_ngcontent-%COMP%]:hover{border-color:#667eea;box-shadow:0 2px 8px #667eea1a}.uid-input-wrapper[_ngcontent-%COMP%]:focus-within{border-color:#667eea;box-shadow:0 2px 12px #667eea33}.uid-input-icon[_ngcontent-%COMP%]{color:#718096;margin-right:12px;font-size:20px;width:20px;height:20px}.uid-input[_ngcontent-%COMP%]{flex:1;border:none;outline:none;font-size:16px;padding:8px 0;background:transparent;color:#2d3748}.uid-input[_ngcontent-%COMP%]::placeholder{color:#a0aec0}.uid-actions[_ngcontent-%COMP%]{display:flex;gap:4px;margin-left:8px}.uid-action-btn[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;align-items:center;justify-content:center}.uid-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:.9em;padding:4px 12px;border-radius:4px;margin-left:48px}.uid-status.loading[_ngcontent-%COMP%]{color:#ed8936;background:#fffaf0}.uid-status.success[_ngcontent-%COMP%]{color:#38a169;background:#f0fff4}.uid-status.error[_ngcontent-%COMP%]{color:#e53e3e;background:#fff5f5}.uid-status[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.uid-section-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;padding-top:16px;border-top:1px solid #e2e8f0}.uid-section-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.add-by-uid-btn[_ngcontent-%COMP%]{border-radius:8px;font-weight:500;background:#38a1691a;border-color:#38a169;color:#38a169}.add-by-uid-btn[_ngcontent-%COMP%]:hover{background:#38a16933}.add-by-uid-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.question-uid-badge[_ngcontent-%COMP%]{background:#edf2f7;color:#4a5568;padding:4px 8px;border-radius:12px;font-size:.8em;font-family:Monaco,Consolas,monospace;border:1px solid #cbd5e0}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.uid-input-row[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}@media (max-width: 768px){.add-by-uid-section[_ngcontent-%COMP%]{padding:16px}.uid-input-wrapper[_ngcontent-%COMP%]{padding:8px 12px}.uid-input[_ngcontent-%COMP%]{font-size:14px}.uid-actions[_ngcontent-%COMP%]{flex-wrap:wrap}.uid-action-btn[_ngcontent-%COMP%]{width:32px;height:32px}.uid-section-actions[_ngcontent-%COMP%]{flex-direction:column}.uid-section-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}}.filter-by-tag-section[_ngcontent-%COMP%]{margin:24px 0;padding:24px;background:linear-gradient(135deg,#f8fafc,#edf2f7);border-radius:12px;border:2px solid #e2e8f0;box-shadow:0 2px 8px #0000000d}.filter-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid #e2e8f0}.filter-title[_ngcontent-%COMP%]{margin:0;color:#2d3748;font-size:1.2em;font-weight:600}.filter-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.tags-container[_ngcontent-%COMP%]{min-height:100px}.tags-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;padding:40px;color:#718096}.tags-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px}.tag-button[_ngcontent-%COMP%]{display:flex!important;justify-content:space-between!important;align-items:center!important;padding:12px 16px!important;border-radius:8px!important;border:2px solid #e2e8f0!important;background:#fff!important;transition:all .3s ease!important;text-transform:none!important}.tag-button[_ngcontent-%COMP%]:hover{border-color:#667eea!important;box-shadow:0 2px 8px #667eea1a!important;transform:translateY(-2px)!important}.tag-button.active[_ngcontent-%COMP%]{border-color:#667eea!important;background:linear-gradient(135deg,#667eea,#764ba2)!important;color:#fff!important;box-shadow:0 2px 12px #667eea4d!important}.tag-button.active[_ngcontent-%COMP%]   .tag-count[_ngcontent-%COMP%]{background:#fff3!important}.tag-name[_ngcontent-%COMP%]{font-weight:500;font-size:.95em}.tag-count[_ngcontent-%COMP%]{background:#edf2f7;color:#4a5568;padding:4px 8px;border-radius:12px;font-size:.8em;font-weight:600;min-width:24px;text-align:center}.no-tags[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;padding:40px 20px;color:#718096;text-align:center}.no-tags[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;opacity:.5}.filter-by-tag-btn[_ngcontent-%COMP%]{border-radius:8px;font-weight:500;background:#667eea1a;border-color:#667eea;color:#667eea}.filter-by-tag-btn[_ngcontent-%COMP%]:hover{background:#667eea33}.filter-by-tag-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.filter-indicator[_ngcontent-%COMP%]{color:#667eea;font-weight:500;font-size:.9em;margin-left:8px;background:#667eea1a;padding:2px 8px;border-radius:12px}.question-tags[_ngcontent-%COMP%]{color:#718096;font-size:.8em;background:#edf2f7;padding:2px 8px;border-radius:4px;margin-left:8px}.question-tags-badge[_ngcontent-%COMP%]{background:#edf2f7;color:#4a5568;padding:4px 8px;border-radius:12px;font-size:.8em;display:flex;align-items:center;gap:4px;border:1px solid #cbd5e0}.question-tags-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}@media (max-width: 768px){.filter-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.filter-actions[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.tags-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:8px}.tag-button[_ngcontent-%COMP%]{padding:8px 12px!important;font-size:.9em}}.add-by-uid-section[_ngcontent-%COMP%], .filter-by-tag-section[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .3s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap;align-items:center}.total-questions[_ngcontent-%COMP%]{order:3;margin-left:auto}.add-by-uid-btn[_ngcontent-%COMP%]{order:1}.filter-by-tag-btn[_ngcontent-%COMP%]{order:2}.select-all-btn[_ngcontent-%COMP%]{order:4}@media (max-width: 768px){.action-buttons[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.total-questions[_ngcontent-%COMP%]{order:0;margin-left:0;text-align:center;padding:12px;background:#f8fafc;border-radius:8px}.add-by-uid-btn[_ngcontent-%COMP%], .filter-by-tag-btn[_ngcontent-%COMP%], .select-all-btn[_ngcontent-%COMP%]{width:100%;justify-content:center}}']})};function Ci(a,i){if(a&1){let e=M();r(0,"button",7),_("click",function(){h(e);let n=m();return x(n.openCreateTestDialog())}),r(1,"mat-icon"),s(2,"add"),o(),s(3," Create Test "),o()}}function Mi(a,i){a&1&&(r(0,"div",8),P(1,"mat-spinner"),r(2,"p"),s(3,"Loading tests..."),o()())}function yi(a,i){if(a&1&&(r(0,"div"),s(1),o()),a&2){let e=m().$implicit,t=m(2);F("available",t.canStartTest(e))("ended",!t.canStartTest(e)),c(),v(" Status: ",t.canStartTest(e)?"Available":"Not Available"," ")}}function wi(a,i){if(a&1){let e=M();r(0,"button",17),_("click",function(){h(e);let n=m().$implicit,l=m(2);return x(l.startTest(n))}),s(1),o()}if(a&2){let e=m().$implicit,t=m(2);p("disabled",e.submitted||!t.canStartTest(e)),c(),v(" ",e.submitted?"Test Submitted":"Start Test"," ")}}function Pi(a,i){if(a&1){let e=M();r(0,"div",18)(1,"div",19)(2,"button",20)(3,"mat-icon"),s(4,"download"),o(),s(5," Question PDF "),o(),r(6,"mat-menu",21,0)(8,"button",22),_("click",function(){h(e);let n=m().$implicit,l=m(2);return x(l.downloadPdf(n._id,"en"))}),r(9,"mat-icon"),s(10,"language"),o(),s(11," English Version "),o(),r(12,"button",22),_("click",function(){h(e);let n=m().$implicit,l=m(2);return x(l.downloadPdf(n._id,"hi"))}),r(13,"mat-icon"),s(14,"translate"),o(),s(15," Hindi Version "),o()()(),r(16,"button",23),_("click",function(){h(e);let n=m().$implicit,l=m(2);return x(l.editTest(n))}),r(17,"mat-icon"),s(18,"edit"),o(),s(19," Edit/View "),o(),r(20,"button",24),_("click",function(){h(e);let n=m().$implicit,l=m(2);return x(l.deleteTest(n._id))}),r(21,"mat-icon"),s(22,"delete"),o(),s(23," Delete "),o()()}if(a&2){let e=Le(7);c(2),p("matMenuTriggerFor",e)}}function Ti(a,i){a&1&&(r(0,"div",25),P(1,"mat-spinner",26),r(2,"span"),s(3,"Generating PDF..."),o()())}function Oi(a,i){if(a&1&&(r(0,"mat-card",11)(1,"mat-card-header")(2,"mat-card-title"),s(3),o(),r(4,"mat-card-subtitle")(5,"div"),s(6),Ye(7,"date"),o(),r(8,"div"),s(9),o(),u(10,yi,2,5,"div",12),o()(),r(11,"mat-card-content")(12,"p")(13,"strong"),s(14,"Desc:"),o(),s(15),o(),r(16,"p")(17,"strong"),s(18,"Total Questions:"),o(),s(19),o(),r(20,"p")(21,"strong"),s(22,"Marks Per Question:"),o(),s(23),o(),r(24,"p")(25,"strong"),s(26,"Negative Marks:"),o(),s(27),o(),r(28,"p")(29,"strong"),s(30,"Max Marks:"),o(),s(31),o()(),r(32,"mat-card-actions",13),u(33,wi,2,2,"button",14)(34,Pi,24,1,"div",15),o(),u(35,Ti,4,0,"div",16),o()),a&2){let e=i.$implicit,t=m(2);c(3),w(e.title),c(3),v("Starts: ",Ge(7,12,e.startTime,"medium"),""),c(3),v("Duration: ",e.duration," minutes"),c(),p("ngIf",!t.isAdmin),c(5),v(" ",e.description,""),c(4),v(" ",(e.questionUids==null?null:e.questionUids.length)||e.totalQuestions,""),c(4),v(" ",e.marksPerQuestion,""),c(4),v(" ",e.negativeMarks,""),c(4),v(" ",e.marksPerQuestion*(e.questionUids==null?null:e.questionUids.length)||e.marksPerQuestion*e.totalQuestions,""),c(2),p("ngIf",!t.isAdmin),c(),p("ngIf",t.isAdmin),c(),p("ngIf",t.pdfDownloading()===e._id)}}function ki(a,i){if(a&1&&(r(0,"div",9),u(1,Oi,36,15,"mat-card",10),o()),a&2){let e=m();c(),p("ngForOf",e.tests())}}function Ii(a,i){if(a&1){let e=M();r(0,"button",23),_("click",function(){h(e);let n=m(2);return x(n.openCreateTestDialog())}),s(1," Create your first test "),o()}}function Si(a,i){if(a&1&&(r(0,"div",27)(1,"mat-card")(2,"mat-card-content")(3,"p"),s(4,"No tests available at the moment."),o(),u(5,Ii,2,0,"button",28),o()()()),a&2){let e=m();c(5),p("ngIf",e.isAdmin)}}var mn=class a{authService=g(dt);testService=g(me);dialog=g(Yt);snackBar=g(re);router=g(Ze);tests=C([]);loading=C(!1);pdfDownloading=C(null);isAdmin=this.authService.currentUser()?.role==="admin";ngOnInit(){this.loadTests()}loadTests(){this.loading.set(!0),this.isAdmin?this.testService.getAllTests().subscribe({next:i=>{this.tests.set(i),this.loading.set(!1)},error:i=>{this.snackBar.open("Error loading tests","Close",{duration:3e3}),this.loading.set(!1)}}):this.testService.getUpcomingTests().subscribe({next:i=>{this.tests.set(i),this.loading.set(!1)},error:i=>{this.snackBar.open("Error loading tests","Close",{duration:3e3}),this.loading.set(!1)}})}openCreateTestDialog(i){this.dialog.open(ue,{width:"90vw",maxWidth:"1200px",height:"90vh",maxHeight:"800px",panelClass:"create-test-dialog-panel",autoFocus:!1,data:{test:i||null}}).afterClosed().subscribe(t=>{t&&this.loadTests()})}editTest(i){this.openCreateTestDialog(i)}deleteTest(i){confirm("Are you sure you want to delete this test? This will also delete all associated results.")&&this.testService.deleteTest(i).subscribe({next:()=>{this.snackBar.open("Test deleted successfully","Close",{duration:3e3}),this.loadTests()},error:e=>{this.snackBar.open("Error deleting test: "+e.error?.message,"Close",{duration:3e3})}})}canStartTest(i){if(!i.startTime)return!1;let e=new Date,t=new Date(i.startTime),n=new Date(t.getTime()+(i.duration||0)*6e4);return e>=t&&e<=n}startTest(i){if(this.canStartTest(i))this.router.navigate(["/take-test",i._id]);else{let e=new Date,t=new Date(i.startTime);e<t?this.snackBar.open("Test has not started yet","Close",{duration:3e3}):this.snackBar.open("Test has already ended","Close",{duration:3e3})}}viewResults(i){this.router.navigate(["/results"],{queryParams:{testId:i}})}downloadPdf(i,e){this.pdfDownloading.set(i);let t=e==="en"?"English":"Hindi",l=this.tests().find(d=>d._id===i)?.title||"test";this.testService.downloadQuestionPaperPdf(i,e).subscribe({next:d=>{d.success&&d.base64?(this.downloadBase64Pdf(d.base64,d.fileName||`question-paper-${i}-${e}.pdf`,l),this.snackBar.open(`${t} PDF downloaded successfully!`,"Close",{duration:3e3})):this.snackBar.open("Failed to generate PDF","Close",{duration:3e3}),this.pdfDownloading.set(null)},error:d=>{console.error("Error downloading PDF:",d),this.snackBar.open(`Error downloading ${t} PDF: ${d.error?.message||"Unknown error"}`,"Close",{duration:3e3}),this.pdfDownloading.set(null)}})}downloadBase64Pdf(i,e,t){try{let n=atob(i),l=new Array(n.length);for(let O=0;O<n.length;O++)l[O]=n.charCodeAt(O);let d=new Uint8Array(l),b=new Blob([d],{type:"application/pdf"}),y=window.URL.createObjectURL(b),f=document.createElement("a");f.href=y,f.download=e,f.setAttribute("data-test-title",t),document.body.appendChild(f),f.click(),setTimeout(()=>{document.body.removeChild(f),window.URL.revokeObjectURL(y)},100)}catch(n){console.error("Error processing PDF data:",n),this.snackBar.open("Error processing PDF file","Close",{duration:3e3})}}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=D({type:a,selectors:[["app-live-tests"]],decls:8,vars:5,consts:[["downloadMenu","matMenu"],[1,"live-tests-container"],[1,"header"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["class","loading",4,"ngIf"],["class","tests-grid",4,"ngIf"],["class","no-tests",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[1,"loading"],[1,"tests-grid"],["class","test-card",4,"ngFor","ngForOf"],[1,"test-card"],[3,"available","ended",4,"ngIf"],["align","end"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["class","admin-actions",4,"ngIf"],["class","pdf-loading-overlay",4,"ngIf"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"admin-actions"],[1,"download-pdf-container"],["mat-button","","color","accent",3,"matMenuTriggerFor"],["xPosition","before"],["mat-menu-item","",3,"click"],["mat-button","","color","primary",3,"click"],["mat-button","","color","warn",3,"click"],[1,"pdf-loading-overlay"],["diameter","30"],[1,"no-tests"],["mat-button","","color","primary",3,"click",4,"ngIf"]],template:function(e,t){e&1&&(r(0,"div",1)(1,"div",2)(2,"h1"),s(3),o(),u(4,Ci,4,0,"button",3),o(),u(5,Mi,4,0,"div",4)(6,ki,2,1,"div",5)(7,Si,6,1,"div",6),o()),e&2&&(c(3),w(t.isAdmin?"Manage Tests":"Upcoming Tests"),c(),p("ngIf",t.isAdmin),c(),p("ngIf",t.loading()),c(),p("ngIf",!t.loading()&&t.tests().length>0),c(),p("ngIf",!t.loading()&&t.tests().length===0))},dependencies:[ee,K,J,Xe,Et,Pt,It,Ot,St,kt,Tt,ne,te,Jt,ce,le,de,se,oe,ie,cn,A,B,ln],styles:[".live-tests-container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px}.tests-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:20px}.test-card[_ngcontent-%COMP%]{transition:transform .2s}.test-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;gap:20px}.no-tests[_ngcontent-%COMP%]{text-align:center;padding:40px}.admin-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.available[_ngcontent-%COMP%]{color:#4caf50;font-weight:700}.ended[_ngcontent-%COMP%]{color:#f44336;font-weight:700}@media (max-width: 768px){.header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:flex-start}.tests-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.admin-actions[_ngcontent-%COMP%]{flex-direction:column}}.download-pdf-container[_ngcontent-%COMP%]{position:relative}.pdf-loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#ffffffe6;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;z-index:10;border-radius:4px}.pdf-loading-overlay[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#3f51b5;font-weight:500;font-size:.9em}.test-card[_ngcontent-%COMP%]{position:relative}.download-pdf-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.download-pdf-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:4px}.mat-menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.mat-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px;font-size:20px;width:20px;height:20px}.admin-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;align-items:center}@media (max-width: 768px){.admin-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.admin-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;justify-content:center}.download-pdf-container[_ngcontent-%COMP%], .download-pdf-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}.download-pdf-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#ffc1071a}.mat-menu-item[data-language=en][_ngcontent-%COMP%]{color:#1976d2}.mat-menu-item[data-language=hi][_ngcontent-%COMP%]{color:#d32f2f}"]})};export{mn as LiveTestsComponent};
