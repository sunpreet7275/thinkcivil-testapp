import{a as u}from"./chunk-YH6CXKU6.js";import{c as m}from"./chunk-E6UXEH7R.js";import{z as l}from"./chunk-XHE2WULB.js";import{$ as a,Ac as r,Da as s,ea as o}from"./chunk-L5KBA6Y7.js";var g=class i{constructor(t,e){this.http=t;this.router=e;this.loadUserFromStorage()}apiUrl=`${u.apiUrl}/auth`;currentUserSignal=s(null);menuItemsSignal=s([]);currentUser=r(()=>this.currentUserSignal());menuItems=r(()=>this.menuItemsSignal());isLoggedIn=r(()=>!!this.currentUserSignal());loadUserFromStorage(){let t=localStorage.getItem("token"),e=localStorage.getItem("user"),n=localStorage.getItem("menuItems");t&&e&&n&&(this.currentUserSignal.set(JSON.parse(e)),this.menuItemsSignal.set(JSON.parse(n)))}register(t){return this.http.post(`${this.apiUrl}/register`,t)}login(t){return this.http.post(`${this.apiUrl}/login`,t)}setAuthData(t){localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),localStorage.setItem("menuItems",JSON.stringify(t.menuItems)),this.currentUserSignal.set(t.user),this.menuItemsSignal.set(t.menuItems)}logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("menuItems"),this.currentUserSignal.set(null),this.menuItemsSignal.set([]),this.router.navigate(["/login"])}getToken(){return localStorage.getItem("token")}static \u0275fac=function(e){return new(e||i)(o(l),o(m))};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};export{g as a};
