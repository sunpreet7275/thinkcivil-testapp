import{a as L,b as z,c as G,d as J,e as K,f as Q,g as U,h as W,i as X,j as Y,k as Z}from"./chunk-Q53575U7.js";import{a as j,b as q}from"./chunk-OM2PPL5L.js";import{a as P}from"./chunk-PANJKFIH.js";import{a as F}from"./chunk-446SEP5E.js";import"./chunk-RG53I5Q4.js";import{a as $,c as H,g as A,h as B,i as N}from"./chunk-72GRF44D.js";import{R as O,S as V}from"./chunk-QFTUPGTJ.js";import"./chunk-YH6CXKU6.js";import{c as k}from"./chunk-E6UXEH7R.js";import"./chunk-VFMXLW2S.js";import{l as b,p as w,q as y}from"./chunk-XHE2WULB.js";import{$a as l,Ab as M,Da as C,Hb as i,Ib as a,Jb as _,Kb as d,Lb as p,Nb as D,Rb as I,Sb as c,ac as o,bc as v,cc as f,dc as g,fa as u,lb as T,mc as x,na as S,oa as h,oc as R,rb as s,yb as m,zb as E}from"./chunk-L5KBA6Y7.js";function it(t,e){t&1&&(i(0,"div",5),_(1,"mat-spinner"),i(2,"p"),o(3,"Loading results..."),a()())}function at(t,e){t&1&&(i(0,"div",6)(1,"mat-card")(2,"mat-card-content")(3,"p"),o(4,"No test results available yet."),a(),i(5,"p"),o(6,"Take some tests to see your results here!"),a()()()())}function ot(t,e){t&1&&(i(0,"th",19),o(1,"Test"),a())}function lt(t,e){if(t&1&&(i(0,"td",20)(1,"div",21)(2,"strong"),o(3),a(),i(4,"small"),o(5),x(6,"date"),a()()()),t&2){let n=e.$implicit;l(3),v(n.test.title),l(2),v(R(6,2,n.test.startTime,"medium"))}}function rt(t,e){t&1&&(i(0,"th",19),o(1,"Score"),a())}function st(t,e){if(t&1&&(i(0,"td",20),o(1),a()),t&2){let n=e.$implicit;l(),g(" ",n.score,"/",n.totalMarks," ")}}function mt(t,e){t&1&&(i(0,"th",19),o(1,"Percentage"),a())}function dt(t,e){if(t&1&&(i(0,"td",20)(1,"span"),o(2),a()()),t&2){let n=e.$implicit;l(),M("high-score",n.percentage>=80)("medium-score",n.percentage>=60&&n.percentage<80)("low-score",n.percentage<60),l(),f(" ",n.percentage,"% ")}}function pt(t,e){t&1&&(i(0,"th",19),o(1,"Rank"),a())}function ct(t,e){if(t&1&&(i(0,"span",24),o(1),a()),t&2){let n=c().$implicit,r=c(2);E("background",r.getRankColor(n.rank)),l(),g(" ",n.rank,"",r.getOrdinalSuffix(n.rank)," ")}}function ut(t,e){if(t&1&&(i(0,"span"),o(1),a()),t&2){let n=c().$implicit;l(),f(" out of ",n.totalStudents,"")}}function _t(t,e){if(t&1&&(i(0,"td",20),s(1,ct,2,4,"span",22)(2,ut,2,1,"span",23),a()),t&2){let n=e.$implicit;l(),m("ngIf",n.rank),l(),m("ngIf",n.totalStudents)}}function ft(t,e){t&1&&(i(0,"th",19),o(1,"Submitted"),a())}function Ct(t,e){if(t&1&&(i(0,"td",20),o(1),x(2,"date"),a()),t&2){let n=e.$implicit;l(),f(" ",R(2,1,n.submittedAt,"medium")," ")}}function vt(t,e){t&1&&(i(0,"th",19),o(1,"Actions"),a())}function gt(t,e){if(t&1){let n=D();i(0,"td",20)(1,"button",25),I("click",function(){let et=S(n).$implicit,nt=c(2);return h(nt.viewDetailedResult(et))}),i(2,"mat-icon"),o(3,"visibility"),a(),o(4," View Details "),a()()}}function xt(t,e){t&1&&_(0,"tr",26)}function Rt(t,e){t&1&&_(0,"tr",27)}function St(t,e){if(t&1&&(i(0,"div",7)(1,"mat-card")(2,"mat-card-content")(3,"table",8),d(4,9),s(5,ot,2,0,"th",10)(6,lt,7,5,"td",11),p(),d(7,12),s(8,rt,2,0,"th",10)(9,st,2,2,"td",11),p(),d(10,13),s(11,mt,2,0,"th",10)(12,dt,3,7,"td",11),p(),d(13,14),s(14,pt,2,0,"th",10)(15,_t,3,2,"td",11),p(),d(16,15),s(17,ft,2,0,"th",10)(18,Ct,3,4,"td",11),p(),d(19,16),s(20,vt,2,0,"th",10)(21,gt,5,0,"td",11),p(),s(22,xt,1,0,"tr",17)(23,Rt,1,0,"tr",18),a()()()()),t&2){let n=c();l(3),m("dataSource",n.results()),l(19),m("matHeaderRowDef",n.displayedColumns),l(),m("matRowDefColumns",n.displayedColumns)}}var tt=class t{testService=u(F);authService=u(P);router=u(k);results=C([]);loading=C(!1);displayedColumns=["test","score","percentage","rank","submittedAt","actions"];ngOnInit(){this.loadResults()}loadResults(){this.loading.set(!0),this.testService.getStudentResults().subscribe({next:e=>{this.results.set(e),this.loading.set(!1)},error:e=>{console.error("Error loading results:",e),this.loading.set(!1)}})}viewDetailedResult(e){this.router.navigate(["/result-detail",e._id],{queryParams:{testId:e.test._id}})}getRankColor(e){return e===1?"gold":e===2?"silver":e===3?"#cd7f32":""}getOrdinalSuffix(e){let n=["th","st","nd","rd"],r=e%100;return n[(r-20)%10]||n[r]||n[0]}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=T({type:t,selectors:[["app-results"]],decls:9,vars:3,consts:[[1,"results-container"],[1,"header"],["class","loading",4,"ngIf"],["class","no-results",4,"ngIf"],["class","results-content",4,"ngIf"],[1,"loading"],[1,"no-results"],[1,"results-content"],["mat-table","",1,"results-table",3,"dataSource"],["matColumnDef","test"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","score"],["matColumnDef","percentage"],["matColumnDef","rank"],["matColumnDef","submittedAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"test-info"],["class","rank-badge",3,"background",4,"ngIf"],[4,"ngIf"],[1,"rank-badge"],["mat-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,r){n&1&&(i(0,"div",0)(1,"div",1)(2,"h1"),o(3,"My Test Results"),a(),i(4,"p"),o(5,"View your test performance and rankings"),a()(),s(6,it,4,0,"div",2)(7,at,7,0,"div",3)(8,St,24,3,"div",4),a()),n&2&&(l(6),m("ngIf",r.loading()),l(),m("ngIf",!r.loading()&&r.results().length===0),l(),m("ngIf",!r.loading()&&r.results().length>0))},dependencies:[y,b,w,A,$,H,Z,L,G,U,J,z,W,K,Q,X,Y,V,O,q,j,N,B],encapsulation:2})};export{tt as ResultsComponent};
